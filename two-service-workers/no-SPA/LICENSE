The author of this code is Salva https://stackoverflow.com/users/1142901/salva

This is a copy-paste from https://stackoverflow.com/a/35647786/4094096

Due to the site rules of StackOverflow this code is licensed as CC BY-SA 3.0